# 台股資訊儀表板

![臺灣證券交易所]

## 項目概述

台股資訊儀表板是一個利用 Streamlit 開發的互動式應用程序，專為台灣股市投資者設計。它提供了豐富的數據分析功能，包括每日盤後資訊、三大法人買賣超分析、外資投信同買個股篩選、匯率數據查詢以及股票交易回測功能。通過整合多種數據源，這個儀表板能夠幫助投資者快速了解市場動態，做出更明智的投資決策。

## 主要功能

### 1. 每日盤後資訊
- **三大法人買賣超數據**：直觀顯示外資、投信和自營商的當日買賣超情況
- **期貨未平倉數據**：顯示各類法人在期貨市場的未平倉口數
- **成交量分析**：展示市場每日成交量數據及趨勢

### 2. 外資投信同買個股
- 自動篩選外資和投信同時買進的個股
- 提供完整的買賣數據及股票基本資訊

### 3. 外資買賣超分析
- 展示外資買超前 50 名個股
- 展示外資賣超前 50 名個股
- 提供股票代號、名稱及買賣超股數等詳細信息

### 4. 投信買賣超分析
- 展示投信買超前 50 名個股
- 展示投信賣超前 50 名個股
- 提供股票代號、名稱及買賣超股數等詳細信息

### 5. 台幣匯率數據
- 美元/台幣匯率走勢圖表
- 歷史匯率數據查詢
- 買入與賣出匯率比較

### 6. 交易策略回測
- 基於移動平均線的交易策略回測
- 可自定義股票、日期範圍、移動平均線參數和初始資金
- 提供策略收益率、買入持有收益率、交易次數和勝率等詳細回測指標
- 視覺化交易點位及股價走勢

### 7. 系統日誌功能
- 實時記錄系統運行狀態
- 顯示錯誤和警告信息，便於問題診斷
- 記錄數據更新時間

## 技術實現

此儀表板使用多種技術和工具：

- **Python**：核心開發語言
- **Streamlit**：用於構建網頁界面和交互組件
- **Pandas & NumPy**：用於數據處理和分析
- **Plotly & Matplotlib**：用於數據可視化
- **httpx & aiohttp**：用於非同步數據獲取，提高性能
- **yfinance**：用於獲取股票歷史數據
- **asyncio**：用於異步處理，優化數據獲取效率
- **BeautifulSoup**：用於網頁解析，增強數據獲取的健壯性

## 優化亮點

### 1. 多源數據獲取策略
- 實現了台灣證券交易所 API 和 Yahoo Finance 的雙重數據獲取機制
- 當某個數據源失效時，會自動切換到備用數據源
- 極大提高了系統的可靠性和穩定性

### 2. 智能緩存管理
- 根據數據更新頻率自動調整緩存過期時間
- 頻繁變化的數據（如三大法人買賣超）使用較短的緩存時間 (30分鐘)
- 較穩定的數據（如匯率、期貨）使用較長的緩存時間 (2小時)
- 有效減少 API 請求次數，提高應用性能

### 3. 增強的錯誤處理
- 統一的日誌記錄系統，便於跟蹤和診斷問題
- 異常處理裝飾器簡化了錯誤處理邏輯
- 健壯的重試機制，自動處理網絡波動和臨時性錯誤
- 友好的用戶界面錯誤提示，提升用戶體驗

### 4. 表格解析增強
- 自適應表格解析邏輯，可處理不同格式的數據表格
- 支持多種解析方法（pandas read_html 和 BeautifulSoup）
- 當一種解析方法失敗時自動嘗試其他方法

## 安裝指南

### 系統要求
- Python 3.7 或更高版本
- 網絡連接（用於獲取實時數據）

### 安裝步驟

1. 克隆此倉庫到本地：
```bash
git clone https://github.com/allen-0777/stock.git
cd stock
```

2. 創建並激活虛擬環境：
```bash
python -m venv venv
source venv/bin/activate  # Unix/MacOS
# 或者
venv\Scripts\activate  # Windows
```

3. 安裝所需依賴：
```bash
pip install -r requirements.txt
```

## 使用說明

1. 啟動應用程序：
```bash
streamlit run app.py
```

2. 打開瀏覽器並訪問：
```
http://localhost:8501
```

3. 使用側邊欄的刷新按鈕獲取最新數據

4. 通過頁籤切換不同的功能模塊

## 交易回測使用指南

1. 點擊"交易回測"頁籤
2. 輸入股票代碼（如：2330）
3. 選擇回測日期範圍
4. 設置短期和長期移動平均線的天數
5. 設置初始資金金額
6. 點擊"執行回測"按鈕
7. 查看回測結果，包括收益率、交易記錄和圖表

## 數據源

- 台灣證券交易所 (TWSE)
- 台灣期貨交易所 (TAIFEX)
- 台灣銀行 (BOT)
- Yahoo Finance

## 注意事項

- 由於數據源的限制，部分數據可能存在延遲
- 本儀表板提供的信息僅供參考，投資決策請自行判斷
- 若遇到 SSL 證書問題，可以按提示操作或聯繫開發者

## 貢獻與反饋

歡迎提交 Issue 或 Pull Request 來幫助改進這個項目。如有任何建議或問題，請聯繫我。

